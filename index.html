<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>敏捷思維導入教學行政 - 線上報名</title>
    <!-- 引入 Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 Font Inter (現代、專業字體) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        /* 定義高級典雅色調 */
        .color-primary { color: #1A237E; /* 深靛藍 */ }
        .bg-primary { background-color: #1A237E; }
        .border-accent { border-color: #D4AF37; /* 香檳金 */ }
        .text-accent { color: #D4AF37; }
        
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background-color: #F9F9F9; /* 極淺米白背景 */
            min-height: 100vh;
        }

        /* 自訂輸入框和下拉選單樣式 */
        .elegant-input {
            border: 1px solid #ccc;
            transition: all 0.3s ease;
        }

        .elegant-input:focus {
            outline: none;
            box-shadow: 0 0 0 1px #D4AF37, 0 0 5px rgba(212, 175, 55, 0.5); /* 金色邊框和光暈 */
            border-color: #D4AF37;
        }
        
        /* 自訂單選按鈕視覺效果 */
        input[type="radio"] {
            /* 隱藏瀏覽器預設的圓圈 */
            appearance: none;
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            margin-right: 8px;
            border: 2px solid #333;
            border-radius: 50%;
            display: inline-block;
            position: relative;
            cursor: pointer;
            vertical-align: middle;
            transition: all 0.2s ease;
        }

        input[type="radio"]:checked {
            border-color: #D4AF37; /* 選中時使用金色外框 */
            background-color: #1A237E; /* 內部填充深藍色 */
            border-width: 5px; /* 使圓心看起來更飽滿 */
        }
        
        /* 頁尾樣式 */
        footer {
            border-top: 1px solid #E0E0E0;
        }

    </style>
</head>
<body class="p-4 sm:p-8 flex flex-col items-center">

    <div class="max-w-4xl w-full bg-white rounded-xl shadow-2xl overflow-hidden my-8">
        
        <!-- 頂部標題區塊 -->
        <header class="bg-primary text-white p-8 rounded-t-xl">
            <h1 class="text-3xl sm:text-4xl font-bold mb-1 tracking-wider">
                敏捷思維導入教學行政
            </h1>
            <p class="text-amber-400 text-lg font-light">
                Hello World 2025 開發者大會心得分享暨實務研討會
            </p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 p-8 sm:p-12">
            
            <!-- 活動資訊區塊 (左側或上方) -->
            <div class="lg:col-span-1 space-y-6">
                <h2 class="text-xl font-bold color-primary pb-2 border-b-2 border-accent">
                    活動資訊
                </h2>
                
                <div class="space-y-4 text-gray-700 text-sm">
                    <p>
                        <span class="font-semibold text-accent block mb-1">目的：</span>
                        分享「敏捷開發 (Agile)」的核心精神，並探討如何應用於教學部日常行政與專案管理 (如 QCC、OSCE 籌備) 中，以提升團隊效率與應變能力。
                    </p>
                    
                    <div class="flex items-center space-x-4">
                        <div class="p-3 bg-gray-100 rounded-lg">
                            <!-- 日期/地點 Icon (使用 Lucide icon 的 SVG 替代) -->
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#1A237E" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar-check"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="m9 15 2 2 4-4"/></svg>
                        </div>
                        <div>
                            <p class="font-semibold text-gray-800">日期與時間</p>
                            <p>2025 年 10 月 31 日 (五) | 14:00 - 15:30 (共 1.5 小時)</p>
                        </div>
                    </div>

                    <div class="flex items-center space-x-4">
                        <div class="p-3 bg-gray-100 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#1A237E" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-map-pin"><path d="M12 18s-4-6-4-8a4 4 0 0 1 8 0s-4 2-4 8"/><circle cx="12" cy="10" r="2"/></svg>
                        </div>
                        <div>
                            <p class="font-semibold text-gray-800">地點</p>
                            <p>教學部會議室</p>
                        </div>
                    </div>

                    <!-- !! 新增 Google 行事曆區塊 !! -->
                    <div class="pt-4 border-t border-gray-200 mt-4">
                        <p class="font-semibold text-gray-800 mb-3 flex items-center">
                            <!-- 行事曆 Icon -->
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>
                            參考行事曆
                        </p>
                        <div class="w-full rounded-lg overflow-hidden shadow-sm border border-gray-200">
                            <!-- 請將下方的 src 網址替換為您自己的 Google 日曆嵌入網址 -->
                            <iframe src="https://calendar.google.com/calendar/embed?height=400&wkst=1&bgcolor=%23ffffff&ctz=Asia%2FTaipei&showTitle=0&showNav=1&showDate=1&showPrint=0&showTabs=0&showCalendars=0&showTz=0&src=zh-tw.taiwan%23holiday%40group.v.calendar.google.com&color=%230B8043" 
                                    style="border-width:0" 
                                    width="100%" 
                                    height="300" 
                                    frameborder="0" 
                                    scrolling="no">
                            </iframe>
                        </div>
                        <p class="text-xs text-gray-500 mt-2 italic">
                            (此為範例行事曆，請更換為您的 Google Calendar ID)
                        </p>
                    </div>

                </div>
            </div>

            <!-- 報名表單區塊 (右側或下方) -->
            <div class="lg:col-span-2">
                <h2 class="text-xl font-bold color-primary pb-2 mb-6 border-b-2 border-accent">
                    線上報名
                </h2>

                <form id="registrationForm" class="space-y-6">

                    <!-- 姓名 -->
                    <div class="form-group">
                        <label for="name" class="block text-sm font-medium text-gray-700 mb-2">姓名 <span class="text-red-500">*</span></label>
                        <input type="text" id="name" name="name" required placeholder="請輸入您的真實姓名" class="elegant-input w-full p-3 rounded-lg focus:ring-accent">
                    </div>
                    
                    <!-- 人事號 (新增欄位) -->
                    <div class="form-group">
                        <label for="personnelId" class="block text-sm font-medium text-gray-700 mb-2">人事號 <span class="text-red-500">*</span></label>
                        <input type="text" id="personnelId" name="personnelId" required placeholder="請輸入您的人事編號" class="elegant-input w-full p-3 rounded-lg focus:ring-accent">
                    </div>

                    <!-- 電子郵件 (Email) -->
                    <div class="form-group">
                        <label for="email" class="block text-sm font-medium text-gray-700 mb-2">電子郵件 (Email) <span class="text-red-500">*</span></label>
                        <input type="email" id="email" name="email" required placeholder="example@hospital.org" class="elegant-input w-full p-3 rounded-lg focus:ring-accent">
                    </div>

                    <!-- 職稱 (必填 - 下拉選單) -->
                    <div class="form-group">
                        <label for="title" class="block text-sm font-medium text-gray-700 mb-2">職稱 <span class="text-red-500">*</span></label>
                        <select id="title" name="title" required class="elegant-input w-full p-3 rounded-lg focus:ring-accent">
                            <option value="" disabled selected>-- 請選擇您的職稱 --</option>
                            <option value="doctor">醫師</option>
                            <option value="nurse">護理師</option>
                            <option value="medical">醫事人員</option>
                            <option value="admin">行政人員</option>
                            <option value="other">其他</option>
                        </select>
                    </div>

                    <!-- 是否需要茶水點心？ (單選按鈕) -->
                    <div class="form-group pt-2">
                        <label class="block text-sm font-medium text-gray-700 mb-3">是否需要茶水點心？ <span class="text-red-500">*</span></label>
                        <div class="flex space-x-6">
                            <label class="inline-flex items-center text-gray-800 cursor-pointer">
                                <input type="radio" name="refreshments" value="yes" required>
                                是
                            </label>
                            <label class="inline-flex items-center text-gray-800 cursor-pointer">
                                <input type="radio" name="refreshments" value="no">
                                否
                            </label>
                        </div>
                    </div>

                    <!-- 會前提問 (多行文字輸入框) -->
                    <div class="form-group">
                        <label for="question" class="block text-sm font-medium text-gray-700 mb-2">會前提問 (選填)</label>
                        <textarea id="question" name="question" rows="4" 
                                  placeholder="您目前在行政工作上遇到的困難？或最想了解關於「敏捷」的哪個部分？" 
                                  class="elegant-input w-full p-3 rounded-lg focus:ring-accent resize-none"></textarea>
                    </div>

                    <!-- 確認報名按鈕 -->
                    <button type="submit" 
                            class="w-full bg-primary text-white py-3 mt-4 rounded-lg font-semibold tracking-wider 
                                   hover:bg-indigo-800 transition duration-300 transform hover:scale-[1.01] shadow-lg shadow-indigo-200">
                        確認報名
                    </button>
                </form>

                <!-- 成功訊息區塊 (預設隱藏) -->
                <div id="successMessage" class="mt-8 p-6 bg-amber-50 border-l-4 border-accent text-gray-800 rounded-lg" style="display: none;">
                    <h3 class="text-lg font-semibold text-accent mb-2">報名成功！</h3>
                    <p>感謝您報名參加！您的資料已送出。我們已將確認信函寄送至您的電子郵件信箱。</p>
                </div>
            </div>
            
        </div>

        <!-- 頁尾資訊區塊 -->
        <footer class="p-8 text-center text-sm text-gray-500 bg-gray-50 rounded-b-xl">
            <p>
                主辦單位：教學部 | 聯絡人：盧英云 (<span class="text-gray-600 font-medium">分機57425</span>)
            </p>
            <p class="mt-2 text-xs">
                本報名資料僅供本次研討會聯繫與餐點統計使用，確保您的隱私。
            </p>
        </footer>

    </div>

    <!-- JavaScript 互動與資料送出邏輯 -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('registrationForm');
            const successMsg = document.getElementById('successMessage');
            
            // !! 步驟 4: 請將此處替換為您部署 Apps Script Web App 後獲得的 URL !!
            // 已根據您的要求更新網址
            const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbx9-bim5c5mpGPlvoLFnE4QpW7OsEAuWk2jIWDZQXRAYIIOlpIws3syGWYbE0te0yiTaA/exec"; 

            form.addEventListener('submit', async function(event) {
                event.preventDefault();

                // 簡單的客戶端驗證 (檢查必填欄位)
                const name = document.getElementById('name').value.trim();
                const personnelId = document.getElementById('personnelId').value.trim();
                const email = document.getElementById('email').value.trim();
                const title = document.getElementById('title').value;
                const refreshments = document.querySelector('input[name="refreshments"]:checked');

                if (!name || !personnelId || !email || !title || !refreshments) {
                    // 由於不能使用 alert()，這裡使用自定義的 console.error 和模擬的錯誤提示
                    console.error('Validation Error: Missing required fields.');
                    // 在 UI 上顯示錯誤訊息或使用自定義 modal
                    const submitButton = form.querySelector('button[type="submit"]');
                    submitButton.textContent = '❌ 請檢查必填欄位';
                    setTimeout(() => {
                        submitButton.textContent = '確認報名';
                    }, 2000);
                    return; 
                }

                // 收集表單數據
                const formData = new FormData(form);
                const params = new URLSearchParams();
                for (const [key, value] of formData.entries()) {
                    params.append(key, value);
                }

                // 顯示送出中的訊息
                const submitButton = form.querySelector('button[type="submit"]');
                submitButton.textContent = '送出中...';
                submitButton.disabled = true;

                try {
                    // 發送 POST 請求到 Apps Script Web App
                    const response = await fetch(WEB_APP_URL, {
                        method: 'POST',
                        // 將 FormData 轉換為 application/x-www-form-urlencoded 格式
                        body: params, 
                    });

                    // 檢查 Apps Script 是否成功執行
                    if (!response.ok) {
                        throw new Error(`伺服器或網路錯誤 (HTTP Status: ${response.status})`);
                    }
                    
                    const result = await response.json();

                    if (result.result === 'success') {
                        // 視覺化互動：隱藏表單並顯示成功訊息
                        form.style.display = 'none'; 
                        successMsg.style.display = 'block';
                        successMsg.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        console.log('報名資料已成功送出到 Google Sheets:', result.data);
                    } else {
                        // 處理 Apps Script 返回的錯誤
                         console.error(`報名失敗，伺服器返回錯誤。請檢查 Apps Script 程式碼。\n錯誤訊息: ${JSON.stringify(result)}`);
                         submitButton.textContent = '❌ 提交失敗，請檢查控制台';
                    }

                } catch (error) {
                    // 處理網路錯誤或解析錯誤
                    console.error('Submission Error:', error);
                    submitButton.textContent = '❌ 網路錯誤，請重試';
                } finally {
                    // 無論成功或失敗，恢復按鈕狀態（除了錯誤訊息顯示時）
                    if (submitButton.textContent.includes('❌')) {
                        setTimeout(() => {
                            submitButton.textContent = '確認報名';
                            submitButton.disabled = false;
                        }, 2000);
                    } else {
                         submitButton.disabled = false;
                    }
                }
            });
        });
    </script>
</body>
</html>
    </script>
</body>
</html>
